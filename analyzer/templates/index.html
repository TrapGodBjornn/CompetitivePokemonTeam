<!DOCTYPE html>
<html>
<head>
    <title>The Battle Lab</title>
    <style>
        /* Update base colors for better contrast */
        :root {
            --dark-gold: #B8860B;      /* Darker reddish gold */
            --medium-gold: #DAA520;    /* Medium reddish gold */
            --light-gold: #DEB887;     /* Light reddish gold */
            --cream-gold: #F5DEB3;     /* Cream with gold tint */
            --text-dark: #2C1810;      /* Dark brown text */
            --reddish-gold: #CD853F;   /* Peru - reddish gold */
        }

        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;  /* Reduced from 1600px */
            margin: 0 auto;
            padding: 10px 40px;
            font-size: 16px;  /* Reduced from 18px */
            background: linear-gradient(135deg, #CD853F, #8B4513);  /* Reddish gold to saddle brown */
            background-attachment: fixed;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(45deg, 
                    rgba(205, 133, 63, 0.1) 0px,  /* Subtle reddish gold pattern */
                    rgba(205, 133, 63, 0.1) 2px,
                    transparent 2px, 
                    transparent 4px);
            pointer-events: none;
            z-index: -1;
        }
        
        h1 {
            color: #8B0000;  /* Dark red */
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            font-size: 2.5em;  /* Banner title stays large */
        }
        
        h2 {
            font-size: 1.8em;  /* Reduced from 2.2em */
        }
        
        h3 {
            font-size: 1.4em;  /* Reduced from 1.7em */
        }
        
        h4 {
            font-size: 1.2em;  /* Reduced from 1.4em */
        }
        
        .pokemon-input, input, select, #results, .team-summary, .pokemon-meta, .pokemon-analysis { 
            background: var(--cream-gold);
        }
        
        .pokemon-input {
            margin: 0;
            padding: 8px 12px;  /* Slightly more horizontal padding */
            background: #E8D5BC;
            border: 1px solid #DAA520;
            border-radius: 4px;
        }
        
        .pokemon-input label {
            display: block;
            margin-bottom: 4px;
            font-size: 0.9em;
            color: #666;
        }
        
        .pokemon-input input {
            width: 90%;  /* Reduced from 100% */
            padding: 3px 6px;  /* Reduced from 4px 8px */
            border: 1px solid #DAA520;
            border-radius: 4px;
            background: white;
            margin: 0 auto;  /* Center the input */
            display: block;  /* Allow margin auto to work */
            font-size: 0.95em;
        }
        
        input, select {
            width: 90%;
            padding: 10px;
            margin: 3px 0;
            border: 1px solid #DAA520;  /* Gold border */
            border-radius: 4px;
            font-size: 1.2em;
        }
        
        button {
            max-width: 800px;
            margin: 15px auto;
            display: block;
            width: 100%;
            padding: 12px;  /* Reduced from 15px */
            background: linear-gradient(to right, #8B0000, #A52A2A);
            color: #FFFAF0;  /* Cream text */
            border: 2px solid #DAA520;  /* Gold border */
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2em;  /* Reduced from 1.3em */
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            transform: translateY(-1px);
        }
        
        #results {
            margin-top: 20px;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #DAA520;  /* Gold border */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .warning {
            color: #d63031;
            margin: 5px 0;
        }
        
        .balanced {
            color: #006400;  /* Dark green */
            font-weight: bold;
        }
        
        .replacement {
            margin: 15px 0;
            padding: 10px;
            border-left: 3px solid #4CAF50;
            background: #f9f9f9;
        }
        
        .critical {
            background-color: #FFB6C1;  /* Darker red */
            border-left: 3px solid #f44336;
        }
        
        .replacement-suggestions {
            color: var(--text-dark);  /* Use our dark text color */
        }
        
        .replacement-suggestions ul {
            margin: 5px 0;
            padding-left: 20px;
            color: var(--text-dark);  /* Ensure all text is dark */
        }
        
        .replacement-suggestions ul ul {
            color: var(--text-dark);  /* Override previous white color */
        }
        
        /* Make sure nested lists are also readable */
        .replacement-suggestions li,
        .replacement-suggestions li strong,
        .replacement-suggestions li ul li {
            color: var(--text-dark);
        }
        
        /* Add a bit more contrast to the background */
        .replacement-suggestions {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            border-radius: 4px;
            padding: 10px;
            margin-top: 8px;
        }
        
        .team-summary {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background: linear-gradient(135deg, #E8D5A7, #D4C091);
            border: 1px solid #DAA520;  /* Gold border */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .pokemon-entry {
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            font-size: 1.1em;
        }
        
        .pokemon-entry.balanced {
            background: #E8D5BC;  /* Match the box color */
            color: #006400;  /* Dark green */
        }
        
        .pokemon-entry.warning {
            background: #FFE4E1;  /* Light red */
            color: #8B0000;  /* Dark red */
        }
        
        .pokemon-entry.critical {
            background: #FFB6C1;  /* Darker red */
            color: #8B0000;  /* Dark red */
        }
        
        .pokemon-name {
            color: var(--text-dark);
            font-weight: 600;
        }
        
        .pokemon-role {
            color: #666;
            font-size: 1.2em;
            line-height: 1.5;
        }
        
        .type-vulnerability {
            margin: 10px 0;
            padding: 10px;
            background: linear-gradient(to right, #A52A2A, #8B0000);
            border-radius: 4px;
            border: 1px solid rgba(139, 0, 0, 0.3);
        }
        
        .role-coverage {
            margin: 10px 0;
            padding: 15px;
            background: linear-gradient(45deg, #E8D5A7, #DAA520);
            border-radius: 8px;
            border: 1px solid #DAA520;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .pokemon-analysis {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            color: var(--text-dark);
        }
        
        .pokemon-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
        }
        
        .pokemon-header .pokemon-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #000000;  /* Black text for Pokemon names */
        }
        
        .pokemon-header .pokemon-role {
            color: #666;
            font-style: italic;
        }
        
        .weakness-info {
            margin: 8px 0;
            padding: 12px;
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border-radius: 4px;
            border: 1px solid var(--medium-gold);
            color: var(--text-dark);
        }
        
        .weakness-info p {
            font-size: 1.2em;
            line-height: 1.5;
        }
        
        .replacement-item {
            margin: 10px 0;
        }
        
        .replacement-item strong {
            color: #8B0000;  /* Dark red for Pokemon names */
            font-weight: bold;
        }
        
        .meta-team {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;  /* Increased gap between cards */
            width: 100%;
            padding: 20px;  /* Add padding around grid */
        }
        
        .pokemon-meta {
            margin: 0;  /* Remove margin since we're using grid gap */
            min-width: 0;  /* Allow boxes to shrink if needed */
            padding: 8px;  /* Reduced from 10px */
            border-radius: 8px;
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            transition: transform 0.2s ease;
        }
        
        .pokemon-meta:hover {
            transform: translateY(-2px);
        }
        
        .pokemon-meta.replacement {
            border-left: 4px solid #8B0000;  /* Dark red */
        }
        
        .meta-details {
            margin-left: 12px;
            color: var(--text-dark);
        }
        
        .meta-details p {
            font-size: 1.2em;
            line-height: 1.5;
        }
        
        .moveset {
            background: linear-gradient(165deg, var(--light-gold), var(--medium-gold));
            padding: 10px;
            border-radius: 4px;
            margin-top: 8px;
            border: 1px solid var(--medium-gold);
            font-size: 1.1em;
            color: var(--text-dark);
        }
        
        .moveset ul {
            list-style-type: none;
            padding-left: 15px;
        }
        
        /* Regular type badges (current size) */
        .type-badge {
            display: inline-block;
            padding: 4px 8px;  /* Reduced from 5px 10px */
            border-radius: 10px;
            font-family: monospace;
            font-weight: bold;
            font-size: 0.9em;  /* Reduced from 1em */
            margin: 2px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }
        
        /* Smaller type badges for analysis and meta sections */
        .pokemon-analysis .type-badge,
        .pokemon-meta .type-badge,
        .meta-details .type-badge {
            padding: 3px 8px;
            border-radius: 8px;
            font-size: 0.9em;
            margin: 1px;
        }
        
        .type-bug { background-color: #92BC2C; }
        .type-dark { background-color: #595761; }
        .type-dragon { background-color: #0C69C8; }
        .type-electric { background-color: #F2D94E; color: black; }
        .type-fairy { background-color: #EE90E6; }
        .type-fighting { background-color: #D3425F; }
        .type-fire { background-color: #FBA54C; }
        .type-flying { background-color: #A1BBEC; }
        .type-ghost { background-color: #5F6DBC; }
        .type-grass { background-color: #5FBD58; }
        .type-ground { background-color: #DA7C4D; }
        .type-ice { background-color: #75D0C1; }
        .type-normal { background-color: #A0A29F; }
        .type-poison { background-color: #B763CF; }
        .type-psychic { background-color: #FA8581; }
        .type-rock { background-color: #C9BB8A; }
        .type-steel { background-color: #5695A3; }
        .type-water { background-color: #539DDF; }
        
        .type-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .type-header span {
            color: #666;
        }
        
        /* Banner sprites - increase size and adjust spacing */
        .banner-sprite {
            width: 95px;  /* Increased from 85px */
            height: 95px;
            position: absolute;
            transition: transform 0.3s ease;
            z-index: 2;
        }
        
        /* Analysis sprites - increase size */
        .analysis-sprite {
            width: 70px;  /* Increased from 50px */
            height: 70px;
            vertical-align: middle;
            margin-right: 12px;
        }
        
        .pokemon-entry {
            display: flex;
            align-items: center;
        }
        
        .pokemon-meta h4 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .tier-select {
            background: linear-gradient(135deg, #E8D5A7, #DAA520);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 25px;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .tier-select select {
            background: linear-gradient(to right, #FFF5E6, #F8ECD1);  /* Soft cream */
            border: 1px solid #D4B88C;  /* Softer gold border */
            transition: all 0.2s ease;
            width: 100%;
            padding: 8px;
            border-radius: 4px;
        }
        
        .tier-select select:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .pokemon-analysis.critical {
            background: linear-gradient(135deg, #A52A2A, #8B0000);  /* Dark red gradient */
            border-left: 4px solid #8B0000;
        }
        
        .pokemon-analysis.warning {
            background: linear-gradient(135deg, #CD5C5C, #A52A2A);  /* Lighter red gradient */
            border-left: 4px solid #8B0000;
        }
        
        /* Add container for type vulnerabilities section */
        .vulnerabilities-container {
            margin: 10px 0;  /* Reduced from 20px */
            padding: 15px;
            border-radius: 8px;
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Add these CSS rules for the new layout */
        .analysis-container {
            display: grid;
            grid-template-columns: 1fr 1fr;  /* Two equal columns */
            gap: 20px;
            margin: 20px 0;
        }
        
        /* Container styling */
        .team-summary, .vulnerabilities-container, .type-analysis-container, .meta-team-container {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
        }
        
        /* Type analysis grid */
        .type-analysis-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;  /* Reduced gap */
            padding: 5px;  /* Reduced padding */
        }
        
        /* Meta team grid */
        .meta-team {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;  /* Reduced gap */
            padding: 5px;  /* Reduced padding */
        }
        
        /* Individual Pokemon cards */
        .pokemon-analysis, .pokemon-meta {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            border-radius: 8px;
            padding: 8px;  /* Reduced from 10px */
            margin: 0;
            min-width: 0;  /* Allow shrinking */
        }
        
        /* Top section layout */
        .top-container {
            display: grid;
            grid-template-columns: 1fr 1fr;  /* Two equal columns */
            gap: 20px;
            margin: 20px 0;
        }
        
        /* Full width containers */
        .type-analysis-container, .meta-team-container {
            width: auto;  /* Changed from 100% */
            margin: 15px 20px;  /* Added horizontal margin */
            padding: 12px;
        }
        
        /* Grid layouts for cards */
        .type-analysis-grid, .meta-team {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;  /* Reduced gap */
            padding: 5px;  /* Reduced padding */
        }
        
        /* Analysis text */
        .replacement-suggestions p,
        .meta-details p {
            font-size: 1.2em;
            line-height: 1.5;
        }
        
        /* Update container styles */
        .type-analysis-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Style for problem Pokemon section */
        .problem-pokemon-section {
            background: linear-gradient(165deg, var(--cream-gold), var(--dark-gold));
            padding: 15px;  /* Reduced from 20px */
        }
        
        .problem-pokemon-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        /* Style for non-problem Pokemon section */
        .no-problem-pokemon-section {
            background: linear-gradient(165deg, var(--cream-gold), var(--dark-gold));
            padding: 15px;  /* Reduced from 20px */
        }
        
        .no-problem-pokemon-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        /* Update role coverage text */
        .role-coverage p {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            color: var(--text-dark);
            padding: 8px;
            border-radius: 4px;
            margin: 5px 0;
        }
        
        /* Add banner styling */
        .banner {
            background: linear-gradient(135deg, #E8D5A7, #DAA520, #8B0000, #DAA520, #E8D5A7);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
            min-height: 160px;  /* Increased from 140px */
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }
        
        .banner h1 {
            margin: 0;
            color: #8B0000;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            text-align: center;
            z-index: 1;
        }
        
        /* Left triangle - more spread out */
        #pokemon1 { top: 10px; left: 4%; }      /* Blaziken - adjusted left */
        #pokemon2 { top: 45px; left: 13%; }     /* Arcanine - more space */
        #pokemon3 { top: 80px; left: 22%; }     /* Volcarona - more space */
        
        /* Right triangle - more spread out */
        #pokemon4 { top: 10px; right: 4%; }     /* Ho-Oh - adjusted right */
        #pokemon5 { top: 45px; right: 13%; }    /* Infernape - more space */
        #pokemon6 { top: 80px; right: 22%; }    /* Charizard - more space */
        
        .banner-sprite:hover {
            transform: scale(1.1);
        }
        
        /* Update team inputs grid */
        #teamInputs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);  /* Change to 3 columns */
            gap: 10px;
            margin: 10px auto;
            max-width: 800px;
        }
        
        /* Type analysis container - refined gradient */
        .type-analysis-container {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
        }
        
        /* Meta team cards - elegant gradient */
        .pokemon-meta {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
        }
        
        .pokemon-meta:hover {
            transform: translateY(-2px);
        }
        
        /* Role coverage section - warm gradient */
        .role-coverage {
            background: linear-gradient(135deg, #E6D5B9, #C4A484);
            border: 1px solid #DAA520;
        }
        
        /* Analyze button - more appealing gradient */
        button:hover {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            transform: translateY(-1px);
        }
        
        /* Type vulnerability cards - subtle gradient */
        .type-vulnerability {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            border: 1px solid rgba(139, 0, 0, 0.3);
        }
        
        /* Team summary - elegant gradient */
        .team-summary {
            background: linear-gradient(135deg, #E6D5B9, #D4B88C);
        }
        
        /* Update the main analysis boxes with gradients */
        .team-section, .vulnerabilities-section {
            background: linear-gradient(165deg, var(--medium-gold), var(--dark-gold));
            border: 1px solid var(--medium-gold);
            border-radius: 8px;
            padding: 15px;  /* Reduced from 20px */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            color: var(--text-dark);
        }
        
        /* Update the team summary box */
        .team-summary {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
        }
        
        /* Update vulnerability container */
        .vulnerabilities-container {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
        }
        
        /* Individual vulnerability items */
        .type-vulnerability {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            border: 1px solid rgba(139, 0, 0, 0.3);
            transition: transform 0.2s ease;
        }
        
        .type-vulnerability:hover {
            transform: translateY(-2px);
        }
        
        /* Pokemon analysis cards */
        .pokemon-analysis {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }
        
        .pokemon-analysis:hover {
            transform: translateY(-2px);
        }
        
        /* Override for critical and warning states */
        .pokemon-analysis.critical {
            background: linear-gradient(135deg, #A52A2A, #8B0000);  /* Dark red gradient */
            border-left: 4px solid #8B0000;
        }
        
        .pokemon-analysis.warning {
            background: linear-gradient(135deg, #CD5C5C, #A52A2A);  /* Lighter red gradient */
            border-left: 4px solid #8B0000;
        }
        
        .pokemon-analysis.balanced {
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);  /* Soft green */
        }
        
        /* Weakness info sections */
        .weakness-info {
            background: linear-gradient(165deg, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.9));
            border: 1px solid #D4B88C;
            backdrop-filter: blur(5px);
        }
        
        /* Results Section Improvements */
        #results h2 {
            text-align: center;
            color: #8B0000;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 3px solid #DAA520;
        }
        
        .pokemon-analysis, .pokemon-meta {
            transition: all 0.3s ease;
        }
        
        .pokemon-analysis:hover, .pokemon-meta:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .type-analysis-container h4, 
        .meta-team-container h4 {
            background: linear-gradient(to right, #8B0000, #A52A2A);
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            margin-top: 0;
        }
        
        /* Loading State Enhancement */
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2em;
            color: #8B0000;
            background: linear-gradient(165deg, #E6D5B9, #D4B88C);
            border-radius: 8px;
            margin: 20px 0;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        /* Role Coverage Section Enhancement */
        .role-coverage {
            background: linear-gradient(165deg, #E6D5B9, #D4B88C);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .role-coverage p {
            padding: 8px;
            border-radius: 4px;
            background: rgba(248, 236, 209, 0.5);  /* Soft cream with transparency */
            margin: 5px 0;
        }
        
        .role-coverage .warning {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid #8B0000;
        }
        
        /* Adjust containers to accommodate larger sprites */
        .pokemon-entry, .pokemon-header {
            min-height: 75px;  /* Ensure enough height for larger sprites */
            padding: 10px;     /* Add more padding */
        }
        
        /* Meta team sprites */
        .pokemon-meta h4 img.analysis-sprite {
            width: 70px;  /* Match other analysis sprites */
            height: 70px;
        }
        
        /* Adjust text alignment */
        .pokemon-name {
            font-size: 1.1em;  /* Slightly larger text to match larger sprites */
        }
        
        /* Make warning/critical colors more red */
        .pokemon-analysis.critical {
            background: linear-gradient(135deg, #A52A2A, #8B0000);  /* Dark red gradient */
            border-left: 4px solid #8B0000;
        }
        
        .pokemon-analysis.warning {
            background: linear-gradient(135deg, #CD5C5C, #A52A2A);  /* Lighter red gradient */
            border-left: 4px solid #8B0000;
        }
        
        /* Type analysis boxes - softer gold */
        .type-analysis-container {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
        }
        
        /* Vulnerability warnings - more red */
        .type-vulnerability {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            border: 1px solid rgba(139, 0, 0, 0.3);
        }
        
        /* Role coverage warnings */
        .role-coverage .warning {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            border-left: 4px solid #8B0000;
        }
        
        /* Container backgrounds - softer gold */
        .team-section, 
        .vulnerabilities-section,
        .problem-pokemon-section,
        .no-problem-pokemon-section {
            background: linear-gradient(165deg, var(--medium-gold), var(--dark-gold));
            color: var(--text-dark);
        }
        
        /* Text color in red sections */
        .pokemon-analysis.critical,
        .pokemon-analysis.warning,
        .type-vulnerability,
        .role-coverage .warning {
            color: #FFFFFF;  /* White text for better contrast */
        }
        
        /* Keep the hover effects */
        .pokemon-analysis:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(139, 0, 0, 0.2);
        }

        .welcome-section {
            background: linear-gradient(165deg, var(--cream-gold), var(--light-gold));
            border: 1px solid var(--medium-gold);
            border-radius: 12px;
            margin: 20px auto 30px;
            padding: 25px;
            max-width: 1000px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .welcome-content {
            color: var(--text-dark);
        }

        .welcome-content h2 {
            color: #8B0000;
            margin-top: 0;
            text-align: center;
            border-bottom: 2px solid var(--medium-gold);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .welcome-content h3 {
            color: #8B0000;
            margin-top: 20px;
        }

        .how-it-works {
            background: linear-gradient(165deg, rgba(255,255,255,0.5), rgba(255,255,255,0.3));
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .how-it-works ol {
            padding-left: 20px;
        }

        .how-it-works ul {
            padding-left: 30px;
        }

        .how-it-works li {
            margin: 8px 0;
            line-height: 1.4;
        }

        .important-note {
            background: linear-gradient(to right, #A52A2A, #8B0000);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .viability-links {
            background: linear-gradient(165deg, rgba(255,255,255,0.5), rgba(255,255,255,0.3));
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .viability-links ul {
            list-style-type: none;
            padding: 0;
        }

        .viability-links li {
            margin: 10px 0;
        }

        .viability-links a {
            color: #8B0000;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.2s ease;
        }

        .viability-links a:hover {
            color: #A52A2A;
            text-decoration: underline;
        }

        /* Add these styles in the <style> section */
        .meta-main-header {
            font-size: 1.8em;
            padding: 20px 0;
            margin: 25px 0;
            border-bottom: 3px solid #2c3e50;
            color: #2c3e50;
        }

        .meta-section-header {
            font-size: 1.5em;
            padding: 15px 0;
            margin: 20px 0;
            border-bottom: 2px solid #ddd;
            color: #2c3e50;
        }

        .optimization-note {
            font-size: 1.1em;
            font-style: italic;
            color: #555;
            margin: 15px 0 25px;
            padding: 15px;
            border-left: 4px solid #4CAF50;
            background-color: #f9f9f9;
            line-height: 1.4;
        }

        /* Add this to the style section */
        .section-banner {
            background: linear-gradient(90deg, #8B0000, #A52A2A);
            color: white;
            padding: 10px 20px;  /* Reduced padding */
            border-radius: 8px;
            margin: 25px 0 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 1.2em;    /* Reduced font size */
            display: flex;
            align-items: center;
            justify-content: center;  /* Center the content */
        }

        .section-banner::before {
            content: '◆';
            margin-right: 10px;
            font-size: 0.8em;
            opacity: 0.8;        /* Slightly transparent diamonds */
        }

        .section-banner::after {
            content: '◆';
            margin-left: 10px;
            font-size: 0.8em;
            opacity: 0.8;        /* Slightly transparent diamonds */
        }

        /* Add hover effect */
        .section-banner:hover {
            background: linear-gradient(90deg, #A52A2A, #8B0000);
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="banner">
        <img src="https://play.pokemonshowdown.com/sprites/gen5/blaziken.png" 
             class="banner-sprite" id="pokemon1" alt="Blaziken">
        <img src="https://play.pokemonshowdown.com/sprites/gen5/arcanine.png" 
             class="banner-sprite" id="pokemon2" alt="Arcanine">
        <img src="https://play.pokemonshowdown.com/sprites/gen5/volcarona.png" 
             class="banner-sprite" id="pokemon3" alt="Volcarona">
        <img src="https://play.pokemonshowdown.com/sprites/gen5/hooh.png" 
             class="banner-sprite" id="pokemon4" alt="Ho-Oh">
        <img src="https://play.pokemonshowdown.com/sprites/gen5/infernape.png" 
             class="banner-sprite" id="pokemon5" alt="Infernape">
        <img src="https://play.pokemonshowdown.com/sprites/gen5/charizard.png" 
             class="banner-sprite" id="pokemon6" alt="Charizard">
        <h1>The Battle Lab</h1>
    </div>
    <div class="welcome-section">
        <div class="welcome-content">
            <h2>Welcome to The Battle Lab</h2>
            <p>Your companion for competitive team building. This tool is specifically designed to help newcomers create balanced, meta-relevant teams with confidence.</p>
            
            <div class="how-it-works">
                <h3>How it works:</h3>
                <ol>
                    <li>Select your desired competitive tier</li>
                    <li>Enter your team members</li>
                    <li>Receive a comprehensive analysis including:
                        <ul>
                            <li>Most problematic Pokemon and suggested replacements</li>
                            <li>Team-wide type weaknesses</li>
                            <li>Individual Pokemon weaknesses and their overlap with team vulnerabilities</li>
                            <li>Role distribution analysis</li>
                            <li>Recommended competitive movesets</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="important-note">
                <p><strong>Note:</strong> To ensure the highest quality recommendations, The Battle Lab only works with Pokemon ranked B or higher in their respective tiers. This aligns with the common advice that beginners should focus on proven options while learning competitive battling.</p>
            </div>

            <div class="viability-links">
                <h3>Current Viability Rankings:</h3>
                <ul>
                    <li><a href="https://www.smogon.com/forums/threads/sv-ubers-viability-rankings.3724082/" target="_blank">Ubers Viability Rankings</a></li>
                    <li><a href="https://www.smogon.com/forums/threads/sv-ou-indigo-disk-viability-ranking-thread-update-on-post-755.3734134/" target="_blank">OU Viability Rankings</a></li>
                    <li><a href="https://www.smogon.com/forums/threads/sv-uu-dlc-2-viability-rankings-update-at-post-281.3735310/" target="_blank">UU Viability Rankings</a></li>
                </ul>
            </div>
        </div>
    </div>
    <form id="analyzerForm">
        <div class="tier-select">
            <label for="tier">Select Tier:</label>
            <select name="tier" id="tier">
                <option value="uber">Uber</option>
                <option value="ou">OU</option>
                <option value="uu">UU</option>
            </select>
        </div>
        
        <div id="teamInputs">
            <!-- Will be populated by JavaScript -->
        </div>
        
        <button type="submit">Analyze Team</button>
    </form>

    <div id="results"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // First, create the form inputs
            const teamInputs = document.getElementById('teamInputs');
            for (let i = 1; i <= 6; i++) {
                const div = document.createElement('div');
                div.className = 'pokemon-input';
                div.innerHTML = `
                    <label for="pokemon${i}">Pokemon ${i}:</label>
                    <input type="text" id="pokemon${i}" name="pokemon${i}" required>
                `;
                teamInputs.appendChild(div);
            }

            // Then, add the form submission handler
            const form = document.getElementById('analyzerForm');
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                console.log("Form submitted");

                const team = [];
                // Get all input values directly from the form
                const formData = new FormData(form);
                let allFilled = true;

                for (let i = 1; i <= 6; i++) {
                    const value = formData.get(`pokemon${i}`);
                    console.log(`Pokemon ${i} value from form:`, value);
                    
                    if (!value || !value.trim()) {
                        allFilled = false;
                        break;
                    }
                    
                    team.push({
                        display: value.trim(),
                        lookup: normalizeNameForLookup(value.trim())
                    });
                }

                if (!allFilled) {
                    document.getElementById('results').innerHTML = '<div class="warning">Please fill in all Pokemon names</div>';
                    return;
                }

                const tier = document.getElementById('tier').value;
                console.log("Sending team:", team);
                console.log("Selected tier:", tier);

                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<div class="loading">Analyzing team...</div>';

                // Make the API request
                try {
                    const response = await fetch('/analyze', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            team: team.map(t => t.lookup),
                            displayNames: team.map(t => t.display),
                            tier
                        })
                    });

                    const data = await response.json();
                    console.log("Received data:", data);  // Debug log
                    
                    if (data.error) {
                        resultsDiv.innerHTML = `<div class="warning">${data.error}</div>`;
                    } else {
                        console.log("Starting display...");  // Debug log
                        displayResults(data);
                        console.log("Display complete");  // Debug log
                    }
                } catch (error) {
                    console.error('Error:', error);
                    resultsDiv.innerHTML = `<div class="warning">Error: ${error.message}</div>`;
                }
            });
        });

        // Keep helper functions outside
        function normalizeNameForLookup(name) {
            const normalized = name.toLowerCase().replace(/[\s\-\.]/g, '');
            console.log(`Normalizing name: ${name} -> ${normalized}`);
            return normalized;
        }

        function getPokemonSprite(name) {
            const spriteName = normalizeNameForLookup(name);
            console.log(`Getting sprite for: ${name} (${spriteName})`);
            
            // Special cases for Pokemon with different sprite names
            const spriteMap = {
                // Necrozma forms
                'necrozmaduskmane': 'necrozma-duskmane',
                'necrozmadawnwings': 'necrozma-dawnwings',
                'necrozmaultra': 'necrozma-ultra',
                
                // Giratina forms
                'giratinaorigin': 'giratina-origin',
                
                // Deoxys forms
                'deoxysattack': 'deoxys-attack',
                'deoxysspeed': 'deoxys-speed',
                'deoxysdefense': 'deoxys-defense',
                
                // Arceus forms
                'arceus': 'arceus',
                'arceusfairy': 'arceus-fairy',
                'arceusground': 'arceus-ground',
                'arceusghost': 'arceus-ghost',
                'arceusbug': 'arceus-bug',
                'arceusdragon': 'arceus-dragon',
                'arceusdark': 'arceus-dark',
                'arceuselectric': 'arceus-electric',
                'arceusfighting': 'arceus-fighting',
                'arceusfire': 'arceus-fire',
                'arceusflying': 'arceus-flying',
                'arceusgrass': 'arceus-grass',
                'arceusice': 'arceus-ice',
                'arceuspoison': 'arceus-poison',
                'arceuspsychic': 'arceus-psychic',
                'arceusrock': 'arceus-rock',
                'arceussteel': 'arceus-steel',
                'arceuswater': 'arceus-water',
                
                // Other special cases
                'calyrexice': 'calyrex-ice',
                'calyrexshadow': 'calyrex-shadow',
                'zaciancrowned': 'zacian-crowned',
                'zamazentacrowned': 'zamenta-crowned',
                'hooh': 'ho-oh',
                'kyuremblack': 'kyurem-black',
                'kyuremwhite': 'kyurem-white'
            };
            
            const finalSpriteName = spriteMap[spriteName] || spriteName;
            console.log(`Final sprite name: ${finalSpriteName}`);
            return `https://play.pokemonshowdown.com/sprites/gen5/${finalSpriteName}.png`;
        }

        function displayResults(data) {
            console.log("Starting displayResults with data:", data);
            const resultsDiv = document.getElementById('results');
            
            try {
                // Validate data
                if (!data || !data.pokemon_problems || !data.tier_data || !data.display_names) {
                    throw new Error("Invalid data structure");
                }
                
                let html = '<h2>Analysis Results</h2>';
                
                // Top section
                html += '<div class="top-container">';
                
                // Left: Your Team
                html += '<div class="team-section">';
                html += '<h3>Your Team:</h3>';
                html += '<div class="team-summary">';
                
                // First calculate significant problems
                const significantProblems = Object.entries(data.problem_types)
                    .filter(([_, info]) => info.total >= 2)  // Changed from > 2 to >= 2
                    .map(([type]) => type);
                
                console.log("Significant team problems:", significantProblems);
                
                const sortedTeam = Object.entries(data.pokemon_problems)
                    .map(([pokemon, info]) => {
                        // Only count weaknesses that overlap with the team's problem types
                        const overlappingWeaknesses = info.problem_types.filter(type => 
                            significantProblems.includes(type)
                        );
                        
                        console.log(`${pokemon} weaknesses:`, info.problem_types);
                        console.log(`${pokemon} overlapping weaknesses:`, overlappingWeaknesses);
                        
                        // Create a new info object with updated score and problem_types
                        return [pokemon, {
                            ...info,
                            score: overlappingWeaknesses.length * 2,  // Adjust score based on overlaps only
                            problem_types: overlappingWeaknesses  // Update problem types to only show overlaps
                        }];
                    })
                    .sort((a, b) => b[1].score - a[1].score);
                
                sortedTeam.forEach(([pokemon, info]) => {
                    const displayName = data.display_names[pokemon] || pokemon;
                    html += `
                        <div class="pokemon-entry ${info.score >= 6 ? 'critical' : info.score > 0 ? 'warning' : 'balanced'}">
                            <img src="${getPokemonSprite(displayName)}" 
                                 class="analysis-sprite" 
                                 onerror="this.style.display='none'">
                            <span class="pokemon-name">${displayName}</span>
                            ${info.score > 0 ? ` - Problem Score: ${info.score}` : ' - No Issues'}
                        </div>`;
                });
                
                html += '</div></div>';
                
                // Right: Team Type Vulnerabilities
                html += '<div class="vulnerabilities-section">';
                html += '<div class="section-banner">Team Type Vulnerabilities</div>';
                html += '<div class="vulnerabilities-container">';
                if (significantProblems.length > 0) {
                    significantProblems.forEach((type) => {
                        html += `<div class="type-vulnerability">
                            <div class="type-header">
                                ${createTypeBadge(type)} 
                                <span>(${data.problem_types[type].total} Pokémon weak)</span>
                            </div>
                            ${data.problem_types[type].fourx.length ? `<p>4x weak: ${data.problem_types[type].fourx.join(', ')}</p>` : ''}
                            ${data.problem_types[type].twox.length ? `<p>2x weak: ${data.problem_types[type].twox.join(', ')}</p>` : ''}
                        </div>`;
                    });
                } else {
                    html += '<p>No significant type vulnerabilities found</p>';
                }
                html += '</div></div></div>';
                
                // Middle: Type Analysis
                html += '<div class="section-banner">Type Analysis</div>';
                html += '<div class="type-analysis-container">';
                html += '<div class="problem-pokemon-grid">';
                
                // Show all Pokemon in one grid
                sortedTeam.forEach(([pokemon, info], index) => {
                    html += `
                        <div class="pokemon-analysis ${info.score > 0 ? (info.score >= 6 ? 'critical' : 'warning') : 'balanced'}">
                            <div class="pokemon-header">
                                <img src="${getPokemonSprite(pokemon)}" 
                                     class="analysis-sprite" 
                                     onerror="this.style.display='none'">
                                <span class="pokemon-name">${pokemon}</span>
                            </div>
                            <div class="weakness-info">
                                ${info.problem_types.length > 0 
                                    ? `<p><strong>Weaknesses:</strong> ${info.problem_types.map(type => createTypeBadge(type)).join(' ')}</p>
                                       <p>Score: ${info.score}</p>`
                                    : '<p>No type vulnerability issues</p>'
                                }
                            </div>
                            ${index < 2 && info.score > 0 && data.pokemon_problems[pokemon]?.replacements?.length > 0 ? `
                                <div class="replacement-suggestions">
                                    <p><strong>Recommended Replacements:</strong></p>
                                    <ul>
                                        ${data.pokemon_problems[pokemon].replacements.map(r => `
                                            <li class="replacement-item">
                                                <strong>${r.name}</strong>
                                                <ul>
                                                    <li>Role: ${r.role}</li>
                                                    <li>Resists ${r.resists} problem type(s)</li>
                                                    <li>Usage Tier: ${r.tier_usage}</li>
                                                </ul>
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                        </div>`;
                });
                
                html += '</div></div>';
                
                // First add the Team Analysis & Recommended Movesets header
                html += '<h3 class="meta-main-header">Team Analysis & Recommended Movesets</h3>';
                html += '<div class="meta-team-container">';
                
                // Current team section
                html += '<div class="section-banner">Current Team Competitive Sets</div>';
                html += '<div class="meta-team">';
                sortedTeam.forEach(([pokemon, info]) => {
                    const movesetData = data.tier_data[pokemon.toLowerCase()]?.Movesets?.[0];
                    const pokemonTypes = data.tier_data[pokemon.toLowerCase()]?.typing || [];
                    html += generatePokemonMetaCard(pokemon, info, movesetData, pokemonTypes);
                });
                html += '</div>';
                
                // Optimized team section right after
                if (data.pokemon_problems && Object.values(data.pokemon_problems).some(p => p.replacements?.length > 0)) {
                    html += '<div class="section-banner">Optimized Team Suggestion</div>';
                    html += `
                        <p class="optimization-note">
                            Consider implementing these changes gradually to evaluate their impact. 
                            While these replacements address current type vulnerabilities, new team dynamics may emerge. 
                            Experiment with each change to find the best balance for your playstyle.
                        </p>`;
                    html += '<div class="meta-team">';
                    
                    // Get top 2 problematic Pokemon
                    const topProblematic = sortedTeam
                        .filter(([_, info]) => info.score > 0)
                        .sort(([_, a], [__, b]) => b.score - a.score)
                        .slice(0, 2);
                    
                    const usedReplacements = new Set();
                    sortedTeam.forEach(([pokemon, info]) => {
                        const isTopProblematic = topProblematic.some(([p]) => p === pokemon);
                        const pokemonData = data.pokemon_problems[pokemon];

                        if (isTopProblematic && pokemonData?.replacements?.length > 0) {
                            let replacement;
                            if (usedReplacements.size === 0) {
                                // First problematic Pokemon gets its best replacement
                                replacement = pokemonData.replacements[0];
                                usedReplacements.add(replacement.name);
                            } else {
                                // Second problematic Pokemon needs to find an unused replacement
                                replacement = pokemonData.replacements.find(r => !usedReplacements.has(r.name));
                            }

                            if (replacement) {
                                const movesetData = data.tier_data[replacement.name.toLowerCase()]?.Movesets?.[0];
                                const pokemonTypes = data.tier_data[replacement.name.toLowerCase()]?.typing || [];
                                html += generatePokemonMetaCard(replacement.name, 
                                    { role: replacement.role }, 
                                    movesetData, 
                                    pokemonTypes,
                                    true,  // isReplacement flag
                                    pokemon  // original Pokemon name
                                );
                            }
                        }
                    });
                    html += '</div>';
                }
                
                html += '</div>';  // Close meta-team-container

                // Add Role Analysis section at the bottom
                html += '<div class="section-banner">Role Analysis</div>';
                html += '<div class="role-analysis-container">';

                // Current team roles
                html += '<h4>Current Team Roles:</h4>';
                html += '<div class="role-coverage">';
                const roleTotals = data.role_totals || {};
                const pokemonByRole = {};
                sortedTeam.forEach(([pokemon, info]) => {
                    if (info.role) {
                        if (!pokemonByRole[info.role]) pokemonByRole[info.role] = [];
                        pokemonByRole[info.role].push(pokemon);
                    }
                });

                for (const [role, count] of Object.entries(roleTotals)) {
                    const pokemonWithRole = pokemonByRole[role] || [];
                    html += `<p><strong>${role} (${count})</strong>: ${pokemonWithRole.join(', ')}</p>`;
                }

                const roleAnalysis = analyzeRoleCoverage(roleTotals);
                if (roleAnalysis.missing.length > 0) {
                    html += `<p class="warning"><strong>Missing Roles:</strong> ${roleAnalysis.missing.join(', ')}</p>`;
                }
                if (roleAnalysis.tooMany.length > 0) {
                    html += `<p class="warning"><strong>Too Many:</strong> ${roleAnalysis.tooMany.map(r => `${r.role} (${r.count})`).join(', ')}</p>`;
                }
                html += '</div>';

                // Optimized team roles (if there are replacements)
                if (data.pokemon_problems && Object.values(data.pokemon_problems).some(p => p.replacements?.length > 0)) {
                    html += '<h4>Optimized Team Roles:</h4>';
                    html += '<div class="role-coverage">';
                    
                    // Calculate new role totals with replacements
                    const newRoleTotals = {...roleTotals};
                    const newPokemonByRole = {...pokemonByRole};
                    const topProblematic = sortedTeam
                        .filter(([_, info]) => info.score > 0)
                        .sort(([_, a], [__, b]) => b.score - a.score)
                        .slice(0, 2);
                    
                    // Track used replacements
                    const usedReplacements = new Set();
                    
                    // Update roles based on replacements
                    topProblematic.forEach(([pokemon, info]) => {
                        const pokemonData = data.pokemon_problems[pokemon];
                        if (!pokemonData?.replacements?.length) return;
                        
                        // Remove old Pokemon's role
                        if (info.role && newPokemonByRole[info.role]) {
                            newPokemonByRole[info.role] = newPokemonByRole[info.role].filter(p => p !== pokemon);
                            newRoleTotals[info.role]--;
                        }
                        
                        // Add replacement's role
                        let replacement;
                        if (usedReplacements.size === 0) {
                            replacement = pokemonData.replacements[0];
                        } else {
                            replacement = pokemonData.replacements.find(r => !usedReplacements.has(r.name));
                        }
                        
                        if (replacement) {
                            usedReplacements.add(replacement.name);
                            if (replacement.role) {
                                if (!newPokemonByRole[replacement.role]) newPokemonByRole[replacement.role] = [];
                                newPokemonByRole[replacement.role].push(replacement.name);
                                newRoleTotals[replacement.role] = (newRoleTotals[replacement.role] || 0) + 1;
                            }
                        }
                    });
                    
                    // Display updated roles
                    for (const [role, count] of Object.entries(newRoleTotals)) {
                        const pokemonWithRole = newPokemonByRole[role] || [];
                        html += `<p><strong>${role} (${count})</strong>: ${pokemonWithRole.join(', ')}</p>`;
                    }
                    
                    const newRoleAnalysis = analyzeRoleCoverage(newRoleTotals);
                    if (newRoleAnalysis.missing.length > 0) {
                        html += `<p class="warning"><strong>Missing Roles:</strong> ${newRoleAnalysis.missing.join(', ')}</p>`;
                    }
                    if (newRoleAnalysis.tooMany.length > 0) {
                        html += `<p class="warning"><strong>Too Many:</strong> ${newRoleAnalysis.tooMany.map(r => `${r.role} (${r.count})`).join(', ')}</p>`;
                    }
                    html += '</div>';
                }

                html += '</div>';
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error("Error in displayResults:", error);
                resultsDiv.innerHTML = `<div class="warning">Error displaying results: ${error.message}</div>`;
            }
        }

        function analyzeRoleCoverage(roleTotals) {
            const expectedRoles = [
                'Lead', 'Special Attacker', 'Physical Attacker', 
                'Utility', 'Pivot', 'Special Wall', 'Physical Wall'
            ];
            const missing = expectedRoles.filter(role => !roleTotals[role]);
            const tooMany = Object.entries(roleTotals)
                .filter(([_, count]) => count > 2)
                .map(([role, count]) => ({role, count}));
            
            return { missing, tooMany };
        }

        // Helper function to create type badge
        function createTypeBadge(type) {
            return `<span class="type-badge type-${type.toLowerCase()}">${type}</span>`;
        }

        // Helper function for replacement suggestions
        function generateReplacementSuggestions(replacements) {
            let html = `
                <div class="replacement-suggestions">
                    <p><strong>Recommended Replacements:</strong></p>
                    <ul>`;
            
            replacements.forEach(r => {
                html += `
                    <li class="replacement-item">
                        <strong>${r.name}</strong>
                        <ul>
                            <li>Role: ${r.role}</li>
                            <li>Resists ${r.resists} problem type(s)</li>
                            <li>Usage Tier: ${r.tier_usage}</li>
                        </ul>
                    </li>`;
            });
            
            html += '</ul></div>';
            return html;
        }

        function displayTeraTypes(teratype) {
            if (!teratype) return createTypeBadge('Unknown');
            
            // Split by ' / ' and create a badge for each type
            return teratype.split(' / ')
                .map(type => createTypeBadge(type))
                .join(' or ');
        }

        // Update the generatePokemonMetaCard function to handle replacement styling
        function generatePokemonMetaCard(pokemon, info, movesetData, pokemonTypes, isReplacement = false, replacedPokemon = null) {
            return `
                <div class="pokemon-meta ${isReplacement ? 'replacement-card' : ''}">
                    <h4>
                        <img src="${getPokemonSprite(pokemon)}" 
                             class="analysis-sprite" 
                             onerror="this.style.display='none'">
                        ${pokemon}
                        ${isReplacement ? `<span class="replacement-tag">(Replacing ${replacedPokemon})</span>` : ''}
                    </h4>
                    <div class="meta-details">
                        <p><strong>Types:</strong> ${Array.isArray(pokemonTypes) ? pokemonTypes.map(type => createTypeBadge(type)).join(' ') : 'Unknown'}</p>
                        <p><strong>Role:</strong> ${info.role || 'Unknown'}</p>
                        ${movesetData ? `
                            <div class="moveset">
                                <p><strong>Held Item:</strong> ${movesetData.helditem || 'Unknown'}</p>
                                <p><strong>Ability:</strong> ${movesetData.ability || 'Unknown'}</p>
                                <p><strong>Tera Type:</strong> ${displayTeraTypes(movesetData.teratype)}</p>
                                <p><strong>EVs:</strong> ${movesetData.EVs || 'Unknown'}</p>
                                <p><strong>Nature:</strong> ${movesetData.nature || 'Unknown'}</p>
                                <p><strong>Moves:</strong></p>
                                <ul>
                                    ${Array.isArray(movesetData.Moves) ? movesetData.Moves.map(move => `<li>${move}</li>`).join('') : '<li>No moves available</li>'}
                                </ul>
                            </div>
                        ` : '<p>No moveset data available</p>'}
                    </div>
                </div>`;
        }
    </script>
</body>
</html>